/*! For license information please see 958.krause.app.js.LICENSE.txt */
"use strict";(self.webpackChunkreact_app=self.webpackChunkreact_app||[]).push([[958],{958:(n,e,t)=>{t.r(e),t.d(e,{loadAdminDashboard:()=>D,loadAgentClients:()=>f,loadAgentDashboard:()=>h,loadClientClaims:()=>N,loadClientDashboard:()=>_,loadClientDetails:()=>g,loadClientPolicies:()=>S,loadDashboardStats:()=>x,loadPaymentHistory:()=>C,loadQuotes:()=>b,updateUserNameInHeader:()=>p});var a=t(753),r=t(456),o=t(209);function c(){var n,e,t="function"==typeof Symbol?Symbol:{},a=t.iterator||"@@iterator",r=t.toStringTag||"@@toStringTag";function o(t,a,r,o){var c=a&&a.prototype instanceof l?a:l,u=Object.create(c.prototype);return i(u,"_invoke",function(t,a,r){var o,c,i,l=0,u=r||[],d=!1,p={p:0,n:0,v:n,a:h,f:h.bind(n,4),d:function(e,t){return o=e,c=0,i=n,p.n=t,s}};function h(t,a){for(c=t,i=a,e=0;!d&&l&&!r&&e<u.length;e++){var r,o=u[e],h=p.p,v=o[2];t>3?(r=v===a)&&(i=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=n):o[0]<=h&&((r=t<2&&h<o[1])?(c=0,p.v=a,p.n=o[1]):h<v&&(r=t<3||o[0]>a||a>v)&&(o[4]=t,o[5]=a,p.n=v,c=0))}if(r||t>1)return s;throw d=!0,a}return function(r,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,v),c=u,i=v;(e=c<2?n:i)||!d;){o||(c?c<3?(c>1&&(p.n=-1),h(c,i)):p.n=i:p.v=i);try{if(l=2,o){if(c||(r="next"),e=o[r]){if(!(e=e.call(o,i)))throw TypeError("iterator result is not an object");if(!e.done)return e;i=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(i=TypeError("The iterator does not provide a '"+r+"' method"),c=1);o=n}else if((e=(d=p.n<0)?i:t.call(a,p))!==s)break}catch(e){o=n,c=1,i=e}finally{l=1}}return{value:e,done:d}}}(t,r,o),!0),u}var s={};function l(){}function u(){}function d(){}e=Object.getPrototypeOf;var p=[][a]?e(e([][a]())):(i(e={},a,function(){return this}),e),h=d.prototype=l.prototype=Object.create(p);function v(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,d):(n.__proto__=d,i(n,r,"GeneratorFunction")),n.prototype=Object.create(h),n}return u.prototype=d,i(h,"constructor",d),i(d,"constructor",u),u.displayName="GeneratorFunction",i(d,r,"GeneratorFunction"),i(h),i(h,r,"Generator"),i(h,a,function(){return this}),i(h,"toString",function(){return"[object Generator]"}),(c=function(){return{w:o,m:v}})()}function i(n,e,t,a){var r=Object.defineProperty;try{r({},"",{})}catch(n){r=0}i=function(n,e,t,a){function o(e,t){i(n,e,function(n){return this._invoke(e,t,n)})}e?r?r(n,e,{value:t,enumerable:!a,configurable:!a,writable:!a}):n[e]=t:(o("next",0),o("throw",1),o("return",2))},i(n,e,t,a)}function s(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var t=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=t){var a,r,o,c,i=[],s=!0,l=!1;try{if(o=(t=t.call(n)).next,0===e){if(Object(t)!==t)return;s=!1}else for(;!(s=(a=o.call(t)).done)&&(i.push(a.value),i.length!==e);s=!0);}catch(n){l=!0,r=n}finally{try{if(!s&&null!=t.return&&(c=t.return(),Object(c)!==c))return}finally{if(l)throw r}}return i}}(n,e)||function(n,e){if(n){if("string"==typeof n)return l(n,e);var t={}.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?l(n,e):void 0}}(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,a=Array(e);t<e;t++)a[t]=n[t];return a}function u(n,e,t,a,r,o,c){try{var i=n[o](c),s=i.value}catch(n){return void t(n)}i.done?e(s):Promise.resolve(s).then(a,r)}function d(n){return function(){var e=this,t=arguments;return new Promise(function(a,r){var o=n.apply(e,t);function c(n){u(o,a,r,c,i,"next",n)}function i(n){u(o,a,r,c,i,"throw",n)}c(void 0)})}}function p(){try{var n=localStorage.getItem("krauser_user");if(!n)return;var e=JSON.parse(n),t=e.email?e.email.split("@")[0]:"Usuario",a=e.full_name||e.name||t;["[data-hero-user]","[data-user-name]","[data-agent-name]","[data-admin-name]"].forEach(function(n){var e=document.querySelector(n);e&&(e.textContent=a)}),console.log("‚úÖ User name updated in header:",a)}catch(n){console.error("Error updating user name in header:",n)}}function h(){return v.apply(this,arguments)}function v(){return(v=d(c().m(function n(){var e,i,s,l,u;return c().w(function(n){for(;;)switch(n.p=n.n){case 0:return console.log("üîÑ loadAgentDashboard() called"),n.p=1,p(),console.log("üì° Requesting agent dashboard data from API..."),n.n=2,a.apiService.request(a.API_CONFIG.ENDPOINTS.AGENT_DASHBOARD,{method:"GET"},{cacheDuration:a.apiService.cache.CACHE_DURATION.SHORT,useCache:!0});case 2:return e=n.v,console.log("üìä Agent dashboard data received:",e),e.stats&&(console.log("Updating agent stats..."),q(e.stats)),e.clients&&(console.log("Rendering agent clients..."),H(e.clients)),e.claims&&(console.log("Rendering agent claims..."),R(e.claims)),console.log("üîÑ Loading recent clients for sidebar..."),n.n=3,V().catch(function(n){return console.error("‚ùå Error loading recent clients:",n)});case 3:return console.log("üîÑ Initializing Agent Dashboard Manager..."),n.p=4,n.n=5,t.e(369).then(t.bind(t,369));case 5:if(i=n.v,s=i.AgentDashboardManager,window.agentDashboard){n.n=7;break}return window.agentDashboard=new s,n.n=6,window.agentDashboard.initialize();case 6:console.log("‚úÖ Agent Dashboard Manager initialized");case 7:n.n=9;break;case 8:n.p=8,l=n.v,console.error("‚ùå Error initializing Agent Dashboard Manager:",l);case 9:return J().catch(function(n){return console.error("Error loading policy health:",n)}),W().catch(function(n){return console.error("Error loading payment trends:",n)}),console.log("‚úÖ Agent dashboard loaded with real data"),n.a(2,e);case 10:throw n.p=10,u=n.v,console.error("‚ùå Error loading agent dashboard:",u),(0,r.D)("Error al cargar datos del dashboard",o.I9.ERROR),u;case 11:return n.a(2)}},n,null,[[4,8],[1,10]])}))).apply(this,arguments)}function f(){return m.apply(this,arguments)}function m(){return(m=d(c().m(function n(){var e,t;return c().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,a.apiService.request(a.API_CONFIG.ENDPOINTS.AGENT_CLIENTS,{method:"GET"},{cacheDuration:a.apiService.cache.CACHE_DURATION.SHORT,useCache:!0});case 1:return e=n.v,n.a(2,e);case 2:return n.p=2,t=n.v,console.error("Error loading clients:",t),n.a(2,[])}},n,null,[[0,2]])}))).apply(this,arguments)}function g(n){return y.apply(this,arguments)}function y(){return(y=d(c().m(function n(e){var t,i;return c().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,a.apiService.request(a.API_CONFIG.ENDPOINTS.GET_CLIENT_DETAILS,{method:"GET",params:{id:e}});case 1:return t=n.v,n.a(2,t);case 2:return n.p=2,i=n.v,console.error("Error loading client details:",i),(0,r.D)("Error al cargar detalles del cliente",o.I9.ERROR),n.a(2,null)}},n,null,[[0,2]])}))).apply(this,arguments)}function b(){return w.apply(this,arguments)}function w(){return(w=d(c().m(function n(){var e,t;return c().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,a.apiService.request(a.API_CONFIG.ENDPOINTS.GET_QUOTES,{method:"GET"},{cacheDuration:a.apiService.cache.CACHE_DURATION.SHORT,useCache:!0});case 1:return e=n.v,n.a(2,e);case 2:return n.p=2,t=n.v,console.error("Error loading quotes:",t),n.a(2,[])}},n,null,[[0,2]])}))).apply(this,arguments)}function _(){return E.apply(this,arguments)}function E(){return(E=d(c().m(function n(){var e,i,l,u,d,h,v;return c().w(function(n){for(;;)switch(n.p=n.n){case 0:return console.log("üîÑ loadClientDashboard() called"),n.p=1,p(),console.log("üì° Requesting client dashboard data from API..."),n.n=2,a.apiService.request(a.API_CONFIG.ENDPOINTS.CLIENT_DASHBOARD,{method:"GET"},{cacheDuration:a.apiService.cache.CACHE_DURATION.SHORT,useCache:!0});case 2:return e=n.v,console.log("üìä Client dashboard data received:",e),console.log("üì° Loading policies, claims, and payments..."),n.n=3,Promise.all([S(),N(),C()]);case 3:return i=n.v,l=s(i,3),u=l[0],d=l[1],h=l[2],console.log("üìä Data loaded - Policies:",null==u?void 0:u.length,"Claims:",null==d?void 0:d.length,"Payments:",null==h?void 0:h.length),e.stats&&(console.log("Updating client stats..."),L(e.stats)),u&&(console.log("Rendering policies..."),G(u)),d&&(console.log("Rendering claims..."),M(d)),h&&(console.log("Rendering payment history..."),k(h)),$().catch(function(n){return console.error("Error loading contacts:",n)}),console.log("üîÑ Initializing payment calendar..."),"function"==typeof window.initPaymentCalendar?window.initPaymentCalendar():Promise.resolve().then(t.bind(t,172)).then(function(n){var e=n.initPaymentCalendar;e&&e()}).catch(function(n){return console.error("Failed to load payment calendar:",n)}),J().catch(function(n){return console.error("Error loading policy health:",n)}),W().catch(function(n){return console.error("Error loading payment trends:",n)}),nn().catch(function(n){return console.error("Error loading pending actions:",n)}),console.log("‚úÖ Client dashboard loaded with real data"),n.a(2,{dashboardData:e,policies:u,claims:d,payments:h});case 4:throw n.p=4,v=n.v,console.error("‚ùå Error loading client dashboard:",v),(0,r.D)("Error al cargar datos del dashboard",o.I9.ERROR),v;case 5:return n.a(2)}},n,null,[[1,4]])}))).apply(this,arguments)}function S(){return T.apply(this,arguments)}function T(){return(T=d(c().m(function n(){var e,t;return c().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,a.apiService.request(a.API_CONFIG.ENDPOINTS.CLIENT_POLICIES,{method:"GET"},{cacheDuration:a.apiService.cache.CACHE_DURATION.MEDIUM,useCache:!0});case 1:return e=n.v,n.a(2,e);case 2:return n.p=2,t=n.v,console.error("Error loading policies:",t),n.a(2,[])}},n,null,[[0,2]])}))).apply(this,arguments)}function C(){return A.apply(this,arguments)}function A(){return(A=d(c().m(function n(){var e,t;return c().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,a.apiService.request(a.API_CONFIG.ENDPOINTS.CLIENT_PAYMENTS,{method:"GET"},{cacheDuration:a.apiService.cache.CACHE_DURATION.MEDIUM,useCache:!0});case 1:return e=n.v,n.a(2,e);case 2:return n.p=2,t=n.v,console.error("Error loading payment history:",t),n.a(2,[])}},n,null,[[0,2]])}))).apply(this,arguments)}function D(){return I.apply(this,arguments)}function I(){return(I=d(c().m(function n(){var e,t;return c().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,p(),n.n=1,a.apiService.request(a.API_CONFIG.ENDPOINTS.ADMIN_DASHBOARD,{method:"GET"},{cacheDuration:a.apiService.cache.CACHE_DURATION.SHORT,useCache:!0});case 1:return(e=n.v).stats&&j(e.stats),e.activity&&F(e.activity),console.log("‚úÖ Admin dashboard loaded with real data"),n.a(2,e);case 2:n.p=2,t=n.v,console.error("Error loading admin dashboard:",t),(0,r.D)("Error al cargar dashboard de administraci√≥n",o.I9.ERROR);case 3:return n.a(2)}},n,null,[[0,2]])}))).apply(this,arguments)}function N(){return O.apply(this,arguments)}function O(){return(O=d(c().m(function n(){var e,t;return c().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,a.apiService.request(a.API_CONFIG.ENDPOINTS.CLIENT_CLAIMS,{method:"GET"},{cacheDuration:a.apiService.cache.CACHE_DURATION.SHORT,useCache:!0});case 1:return e=n.v,n.a(2,e);case 2:return n.p=2,t=n.v,console.error("Error loading claims:",t),n.a(2,[])}},n,null,[[0,2]])}))).apply(this,arguments)}function x(){return P.apply(this,arguments)}function P(){return(P=d(c().m(function n(){var e,t;return c().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,a.apiService.request(a.API_CONFIG.ENDPOINTS.GET_DASHBOARD_STATS,{method:"GET"},{cacheDuration:a.apiService.cache.CACHE_DURATION.SHORT,useCache:!0});case 1:return e=n.v,n.a(2,e);case 2:return n.p=2,t=n.v,console.error("Error loading dashboard stats:",t),n.a(2,null)}},n,null,[[0,2]])}))).apply(this,arguments)}function H(n){var e=document.querySelector("[data-clients-list]");if(e&&n&&0!==n.length){var t=n.map(function(n){var e=n.is_assigned||n.assigned_policies>0,t=e?'<span class="badge badge-primary" style="margin-left: 8px;">Asignado</span>':"",a=n.policy_count||0,r=a>0?"<span>".concat(a," p√≥liza").concat(1!==a?"s":"","</span>"):'<span class="text-muted">Sin p√≥lizas</span>';return'\n        <div class="client-item '.concat(e?"client-assigned":"",'" data-client-id="').concat(n.id,'">\n          <div class="client-info">\n            <h4>\n              ').concat(n.first_name," ").concat(n.last_name,"\n              ").concat(t,"\n            </h4>\n            <p>").concat(n.email,'</p>\n            <div class="client-meta">\n              <span class="badge badge-').concat("active"===n.status?"success":"warning",'">\n                ').concat(n.status,"\n              </span>\n              ").concat(r,"\n              <span>Desde: ").concat(new Date(n.created_at).toLocaleDateString(),'</span>\n            </div>\n          </div>\n          <div class="client-actions">\n            <button class="btn btn-sm btn-outline" onclick="window.appHandlers.viewClientDetails(\'').concat(n.id,"')\">\n              Ver Detalles\n            </button>\n          </div>\n        </div>\n      ")}).join("");e.innerHTML=t}}function R(n){var e=document.querySelector("[data-agent-claims-list]");if(e&&n&&0!==n.length){var t=n.slice(0,5).map(function(n){return'\n    <div class="claim-item" data-claim-id="'.concat(n.id,'">\n      <div class="claim-info">\n        <h4>Claim #').concat(n.claim_number,"</h4>\n        <p>").concat(n.description||"Sin descripci√≥n",'</p>\n        <div class="claim-meta">\n          <span class="badge badge-').concat(z(n.status),'">\n            ').concat(U(n.status),"\n          </span>\n          <span>$").concat(parseFloat(n.claim_amount).toFixed(2),"</span>\n        </div>\n      </div>\n    </div>\n  ")}).join("");e.innerHTML=t}}function q(n){if(n){var e={"stat-clients":n.total_clients||0,"stat-policies":n.active_policies||0,"stat-claims":n.pending_claims||0,"stat-quotes":n.new_quotes||0};Object.entries(e).forEach(function(n){var e=s(n,2),t=e[0],a=e[1],r=document.querySelector("[data-".concat(t,"]"));r&&(r.textContent=a)})}}function L(n){if(n){var e={"[data-stat-policies]":n.active_policies||0,"[data-stat-claims]":n.pending_claims||0,"[data-stat-payments]":n.payment_status||"current","[data-next-payment]":n.next_payment_date?new Date(n.next_payment_date).toLocaleDateString():"N/A","[data-total-monthly]":n.total_monthly?"$".concat(parseFloat(n.total_monthly).toFixed(2)):"$0.00"};Object.entries(e).forEach(function(n){var e=s(n,2),t=e[0],a=e[1],r=document.querySelector(t);r&&(r.textContent=a)}),console.log("‚úÖ Client stats updated:",n)}}function G(n){var e=document.querySelector(".policies-list");if(e)if(n&&0!==n.length){var t={auto:"üöó",home:"üè†",life:"‚ù§Ô∏è",health:"üíº",business:"üè¢",other:"üìÑ"},a=n.map(function(n){var e,a=n.policy_type||n.type||"other",r=n.end_date||n.renewal_date,o=(n.status||"active").toLowerCase();return'\n                <div class="policy-item" data-policy-id="'.concat(n.id,'" data-policy-number="').concat(n.policy_number,'">\n                    <div class="policy-icon">').concat(t[a]||"üìÑ",'</div>\n                    <div class="policy-info">\n                        <h4>Seguro de ').concat((e=a,{auto:"Auto",home:"Hogar",life:"Vida",health:"Salud",business:"Comercial",other:"Otro"}[e]||e),"</h4>\n                        <p>P√≥liza #").concat(n.policy_number,'</p>\n                        <div class="policy-meta">\n                            <span class="badge badge-').concat("active"===o?"success":"expired"===o?"danger":"warning",'">\n                                ').concat(o,"\n                            </span>\n                            <span>").concat(r?"Vence: "+new Date(r).toLocaleDateString():"",'</span>\n                        </div>\n                    </div>\n                    <div class="policy-actions">\n                        <button class="btn btn-sm btn-outline" data-action="view-policy" data-policy-id="').concat(n.id,'">\n                            Ver Detalles\n                        </button>\n                    </div>\n                </div>')}).join("");e.innerHTML=a,e.querySelectorAll('[data-action="view-policy"]').forEach(function(n){n.addEventListener("click",function(n){var e,t=n.currentTarget.dataset.policyId;null!==(e=window.appHandlers)&&void 0!==e&&e.viewPolicy&&window.appHandlers.viewPolicy(t)})}),e.querySelectorAll(".policy-item").forEach(function(n){n.addEventListener("click",function(e){var t;if(!e.target.closest("button")){var a=n.dataset.policyId;null!==(t=window.appHandlers)&&void 0!==t&&t.viewPolicy&&window.appHandlers.viewPolicy(a)}})})}else e.innerHTML='<p class="empty-state">No tienes p√≥lizas activas</p>'}function M(n){var e=document.querySelector("[data-client-claims-list]");if(e)if(n&&0!==n.length){var t=n.map(function(n){return'\n    <div class="claim-item" data-claim-id="'.concat(n.id,'">\n      <div class="claim-info">\n        <h4>Reclamaci√≥n #').concat(n.claim_number,"</h4>\n        <p>").concat(n.description||"Sin descripci√≥n",'</p>\n        <div class="claim-meta">\n          <span class="badge badge-').concat(z(n.status),'">\n            ').concat(U(n.status),"\n          </span>\n          <span>Monto: $").concat(parseFloat(n.claim_amount).toFixed(2),"</span>\n        </div>\n      </div>\n    </div>\n  ")}).join("");e.innerHTML=t}else e.innerHTML='<p class="empty-state">No tienes reclamaciones</p>'}function k(n){var e=document.querySelector("[data-payment-history]");if(e)if(n&&0!==n.length){var t=n.slice(0,10).map(function(n){return'\n    <div class="payment-item" data-payment-id="'.concat(n.id,'">\n      <div class="payment-info">\n                <p class="payment-date">').concat(new Date(n.payment_date||n.date).toLocaleDateString(),'</p>\n        <p class="payment-amount">$').concat(parseFloat(n.amount).toFixed(2),'</p>\n        <span class="badge badge-').concat("completed"===n.status?"success":"warning",'">\n          ').concat(n.status,"\n        </span>\n      </div>\n    </div>\n  ")}).join("");e.innerHTML=t}else e.innerHTML='<p class="empty-state">No hay historial de pagos</p>'}function j(n){if(n){var e={"[data-stat-users]":(n.users_client||0)+(n.users_agent||0)+(n.users_admin||0),"[data-stat-clients]":n.users_client||0,"[data-stat-agents]":n.users_agent||0,"[data-stat-policies]":n.policies_active||0,"[data-stat-claims]":n.pending_claims||0,"[data-stat-revenue]":n.monthly_revenue?"$".concat(parseFloat(n.monthly_revenue).toLocaleString()):"$0"};Object.entries(e).forEach(function(n){var e=s(n,2),t=e[0],a=e[1],r=document.querySelector(t);r&&(r.textContent=a)}),console.log("‚úÖ Admin stats updated:",n)}}function F(n){var e=document.querySelector("[data-admin-activity]");if(e)if(n&&0!==n.length){var t=n.map(function(n){var e="policy"===n.type?"üìÑ":"üîî",t=new Date(n.timestamp).toLocaleDateString();return'\n        <div class="activity-item">\n            <div class="activity-icon">'.concat(e,'</div>\n            <div class="activity-info">\n                <p><strong>').concat(n.user_name,"</strong> ").concat("policy"===n.type?"cre√≥ una p√≥liza":"present√≥ un reclamo",'</p>\n                <p class="activity-meta">').concat("policy"===n.type?n.policy_type:n.claim_type," - ").concat(n.status,'</p>\n                <span class="activity-date">').concat(t,"</span>\n            </div>\n        </div>\n        ")}).join("");e.innerHTML=t}else e.innerHTML='<p class="empty-state">No hay actividad reciente</p>'}function z(n){return{submitted:"primary",under_review:"warning",approved:"success",rejected:"danger",paid:"success"}[n]||"secondary"}function U(n){return{submitted:"Enviado",under_review:"En Revisi√≥n",approved:"Aprobado",rejected:"Rechazado",paid:"Pagado"}[n]||n}function $(){return B.apply(this,arguments)}function B(){return(B=d(c().m(function n(){var e,t,r,o,i;return c().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,a.apiService.request(a.API_CONFIG.ENDPOINTS.GET_CLIENT_CONTACTS,{method:"GET"});case 1:if((e=n.v)&&0!==e.length){n.n=2;break}return console.warn("No contacts found for client"),(t=document.querySelector(".contact-chips"))&&(t.innerHTML='\n                    <div style="text-align: center; padding: 20px; color: #999;">\n                        <p style="margin: 0; font-size: 13px;">No hay contactos asignados</p>\n                    </div>\n                '),n.a(2);case 2:(r=document.querySelector(".contact-chips"))&&(r.innerHTML=e.map(function(n){return'\n                <button class="contact-chip" \n                    data-name="'.concat(n.full_name,'" \n                    data-phone="').concat(n.phone||"No disponible",'" \n                    data-email="').concat(n.email,'" \n                    data-role="').concat(n.role||"Agente",'" \n                    data-policy="').concat(n.policy_types||"‚Äî",'">\n                    ').concat(n.full_name,"\n                </button>\n            ")}).join(""),window.reinitializeContactChips&&window.reinitializeContactChips()),console.log("‚úÖ Client contacts loaded:",e.length),n.n=4;break;case 3:n.p=3,i=n.v,console.error("Error loading client contacts:",i),(o=document.querySelector(".contact-chips"))&&(o.innerHTML='\n                <div style="text-align: center; padding: 20px; color: #f44;">\n                    <p style="margin: 0; font-size: 13px;">Error al cargar contactos</p>\n                </div>\n            ');case 4:return n.a(2)}},n,null,[[0,3]])}))).apply(this,arguments)}function V(){return Q.apply(this,arguments)}function Q(){return(Q=d(c().m(function n(){var e,t,r,o;return c().w(function(n){for(;;)switch(n.p=n.n){case 0:if(console.log("üöÄ loadAgentRecentClients() STARTED"),e=document.querySelector(".recent-clients-pills"),console.log("üìç Container found:",!!e),e){n.n=1;break}return console.log("‚ö†Ô∏è Recent clients container not found"),n.a(2);case 1:return n.p=1,console.log("üì° Loading recent clients from API..."),n.n=2,a.apiService.request(a.API_CONFIG.ENDPOINTS.AGENT_CLIENTS,{method:"GET"},{cacheDuration:a.apiService.cache.CACHE_DURATION.SHORT,useCache:!0});case 2:if(t=n.v,console.log("üìä Clients received:",(null==t?void 0:t.length)||0,t),t&&0!==t.length){n.n=3;break}return console.log("‚ö†Ô∏è No clients to display"),e.innerHTML='\n                <div style="padding: 12px; text-align: center; color: var(--theme-text-secondary); font-size: 0.875rem;">\n                    No hay clientes asignados\n                </div>\n            ',n.a(2);case 3:r=t.sort(function(n,e){return new Date(e.last_policy_update||e.created_at)-new Date(n.last_policy_update||n.created_at)}).slice(0,5),e.innerHTML=r.map(function(n){var e,t,a,r="".concat((null===(e=n.first_name)||void 0===e?void 0:e[0])||"").concat((null===(t=n.last_name)||void 0===t?void 0:t[0])||"").toUpperCase(),o=("".concat(n.first_name||""," ").concat(n.last_name||"").trim(),"".concat(n.first_name||""," ").concat((null===(a=n.last_name)||void 0===a?void 0:a[0])||"",".").trim());return'\n                <button class="client-pill" \n                    onclick="window.appHandlers?.viewClientDetails?.(\''.concat(n.id,'\')">\n                    <span class="client-pill-avatar">').concat(r,'</span>\n                    <span class="client-pill-name">').concat(o,"</span>\n                </button>\n            ")}).join(""),console.log("‚úÖ Loaded ".concat(r.length," recent clients")),n.n=5;break;case 4:n.p=4,o=n.v,console.error("‚ùå Error loading recent clients:",o),e.innerHTML='\n            <div style="padding: 12px; text-align: center; color: var(--theme-text-secondary);">\n                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-bottom: 8px;">\n                    <circle cx="12" cy="12" r="10"/>\n                    <line x1="12" y1="8" x2="12" y2="12"/>\n                    <line x1="12" y1="16" x2="12.01" y2="16"/>\n                </svg>\n                <div style="font-size: 0.875rem;">Error al cargar clientes</div>\n            </div>\n        ';case 5:return n.a(2)}},n,null,[[1,4]])}))).apply(this,arguments)}function J(){return Y.apply(this,arguments)}function Y(){return(Y=d(c().m(function n(){var e,t;return c().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,a.apiService.request("?action=policy_health_stats",{method:"GET"});case 1:(e=n.v).success&&e.stats&&K(e.stats),n.n=3;break;case 2:n.p=2,t=n.v,console.error("Error loading policy health stats:",t);case 3:return n.a(2)}},n,null,[[0,2]])}))).apply(this,arguments)}function K(n){document.querySelectorAll(".chart-card").forEach(function(e){var t=e.querySelector(".chart-title");if(null!=t&&t.textContent.includes("Salud de p√≥lizas")){var a=e.querySelector(".chart-legend");a&&(a.innerHTML='\n                    <span class="chart-legend-item">\n                        <span class="chart-legend-dot" style="background: #38ef7d; box-shadow: 0 0 0 4px rgba(56, 239, 125, 0.12);"></span> \n                        Activas ('.concat(n.active_percent,'%)\n                    </span>\n                    <span class="chart-legend-item">\n                        <span class="chart-legend-dot" style="background: #f5576c; box-shadow: 0 0 0 4px rgba(245, 87, 108, 0.12);"></span> \n                        Riesgo (').concat(n.risk_percent,"%)\n                    </span>\n                ")),console.log("‚úÖ Policy health chart updated:",n)}})}function W(){return X.apply(this,arguments)}function X(){return(X=d(c().m(function n(){var e,t;return c().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,a.apiService.request("?action=payment_trends",{method:"GET"});case 1:(e=n.v).success&&Z(e.trends,e.summary),n.n=3;break;case 2:n.p=2,t=n.v,console.error("Error loading payment trends:",t);case 3:return n.a(2)}},n,null,[[0,2]])}))).apply(this,arguments)}function Z(n,e){document.querySelectorAll(".chart-card").forEach(function(n){var t=n.querySelector(".chart-title");if(null!=t&&t.textContent.includes("Tendencia de pagos")){var a=n.querySelector(".chart-metrics");a&&(a.innerHTML='\n                    <div class="chart-metric">\n                        <span class="label">Total pagos</span>\n                        <span class="value">'.concat(e.total_payments,'</span>\n                    </div>\n                    <div class="chart-metric">\n                        <span class="label">Pagos puntuales</span>\n                        <span class="value">').concat(e.on_time,'</span>\n                    </div>\n                    <div class="chart-metric">\n                        <span class="label">Retrasos</span>\n                        <span class="value">').concat(e.late,"</span>\n                    </div>\n                "));var r=n.querySelector(".chart-legend");r&&(r.innerHTML='\n                    <span class="chart-legend-item"><span class="chart-legend-dot"></span> Pagos</span>\n                    <span class="chart-legend-item" style="color: var(--theme-accent-color);">\n                        '.concat(e.on_time_rate,"% puntualidad\n                    </span>\n                ")),console.log("‚úÖ Payment trends chart updated:",e)}})}function nn(){return en.apply(this,arguments)}function en(){return(en=d(c().m(function n(){var e,t;return c().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,a.apiService.request("?action=pending_actions",{method:"GET"});case 1:(e=n.v).success&&e.actions&&tn(e.actions),n.n=3;break;case 2:n.p=2,t=n.v,console.error("Error loading pending actions:",t);case 3:return n.a(2)}},n,null,[[0,2]])}))).apply(this,arguments)}function tn(n){var e=document.querySelectorAll("[data-pending-actions], .pending-actions-list");if(document.querySelectorAll("[data-actions-count]").forEach(function(e){e.textContent=n.length}),0!==n.length){var t=n.map(function(n){var e=n.days_until,t=e<3?"urgent":e<7?"warning":"info",a=e<0?"Vencido hace ".concat(Math.abs(e),"d"):0===e?"Hoy":"En ".concat(e,"d");return'\n            <div class="pending-action-item '.concat(t,'" style="padding: 10px; border-left: 3px solid ').concat(e<3?"#f5576c":e<7?"#ffa726":"var(--theme-accent-color)",'; margin-bottom: 8px; background: var(--theme-surface-variant); border-radius: 6px;">\n                <div style="display: flex; align-items: start; gap: 10px;">\n                    <div style="flex-shrink: 0; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; color: ').concat(e<3?"#f5576c":e<7?"#ffa726":"var(--theme-accent-color)",';">\n                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                            ').concat(n.action.includes("Pago")?'<rect x="2" y="5" width="20" height="14" rx="2"/><line x1="2" y1="10" x2="22" y2="10"/>':'<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/>','\n                        </svg>\n                    </div>\n                    <div style="flex: 1; min-width: 0;">\n                        <div style="font-weight: 600; font-size: 0.875rem; margin-bottom: 2px;">').concat(n.action,'</div>\n                        <div style="font-size: 0.8125rem; color: var(--theme-text-secondary); margin-bottom: 4px;">').concat(n.policy_number,'</div>\n                        <div style="font-size: 0.75rem; font-weight: 600; color: ').concat(e<3?"#f5576c":e<7?"#ffa726":"var(--theme-text-secondary)",';">').concat(a,"</div>\n                    </div>\n                </div>\n            </div>\n        ")}).join("");e.forEach(function(n){n.innerHTML=t}),console.log("‚úÖ Rendered ".concat(n.length," pending actions"))}else e.forEach(function(n){n.innerHTML='\n                <div style="padding: 20px; text-align: center; color: var(--theme-text-secondary);">\n                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-bottom: 8px; opacity: 0.5;">\n                        <polyline points="20 6 9 17 4 12"/>\n                    </svg>\n                    <p style="margin: 0; font-size: 0.875rem;">No hay acciones pendientes</p>\n                </div>\n            '})}}}]);
//# sourceMappingURL=958.krause.app.js.map